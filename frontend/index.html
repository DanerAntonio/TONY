<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PetShop Manager</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #4e54c8;
            --secondary-color: #8f94fb;
            --accent-color: #ff9a8b;
            --text-color: #333;
            --background-color: #f4f7f6;
        }
        body {
            background-color: var(--background-color);
            color: var(--text-color);
        }
        .navbar {
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
        }
        .btn-primary {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
        }
        .btn-primary:hover {
            background-color: var(--secondary-color);
            border-color: var(--secondary-color);
        }
        .card {
            border: none;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .table {
            background-color: white;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark mb-4">
        <div class="container">
            <a class="navbar-brand" href="#">游 PetShop Manager</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showSection('productos')">Productos</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showSection('compras')">Compras</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showSection('proveedores')">Proveedores</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showSection('clientes')">Clientes</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container">
        <div id="productos" class="section">
            <h2 class="mb-4">Gesti칩n de Productos</h2>
            <button class="btn btn-primary mb-3" onclick="showModal('producto')">Nuevo Producto</button>
            <div class="card">
                <div class="card-body">
                    <div class="mb-3">
                        <input type="text" class="form-control" id="buscarProducto" placeholder="Buscar producto...">
                    </div>
                    <div class="table-responsive">
                        <table class="table table-striped" id="tablaProductos">
                            <thead>
                                <tr>
                                    <th>Nombre</th>
                                    <th>Precio</th>
                                    <th>Stock</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                    <nav aria-label="Paginaci칩n de productos">
                        <ul class="pagination justify-content-center" id="paginacionProductos"></ul>
                    </nav>
                </div>
            </div>
        </div>

        <div id="compras" class="section" style="display: none;">
            <h2 class="mb-4">Gesti칩n de Compras</h2>
            <button class="btn btn-primary mb-3" onclick="showModal('compra')">Nueva Compra</button>
            <div class="card">
                <div class="card-body">
                    <div class="mb-3">
                        <input type="text" class="form-control" id="buscarCompra" placeholder="Buscar compra...">
                    </div>
                    <div class="table-responsive">
                        <table class="table table-striped" id="tablaCompras">
                            <thead>
                                <tr>
                                    <th>Fecha</th>
                                    <th>Proveedor</th>
                                    <th>Total</th>
                                    <th>Estado</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                    <nav aria-label="Paginaci칩n de compras">
                        <ul class="pagination justify-content-center" id="paginacionCompras"></ul>
                    </nav>
                </div>
            </div>
        </div>

        <div id="proveedores" class="section" style="display: none;">
            <h2 class="mb-4">Gesti칩n de Proveedores</h2>
            <button class="btn btn-primary mb-3" onclick="showModal('proveedor')">Nuevo Proveedor</button>
            <div class="card">
                <div class="card-body">
                    <div class="mb-3">
                        <input type="text" class="form-control" id="buscarProveedor" placeholder="Buscar proveedor...">
                    </div>
                    <div class="table-responsive">
                        <table class="table table-striped" id="tablaProveedores">
                            <thead>
                                <tr>
                                    <th>Nombre</th>
                                    <th>Email</th>
                                    <th>Tel칠fono</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                    <nav aria-label="Paginaci칩n de proveedores">
                        <ul class="pagination justify-content-center" id="paginacionProveedores"></ul>
                    </nav>
                </div>
            </div>
        </div>

        <div id="clientes" class="section" style="display: none;">
            <h2 class="mb-4">Gesti칩n de Clientes</h2>
            <button class="btn btn-primary mb-3" onclick="showModal('cliente')">Nuevo Cliente</button>
            <div class="card">
                <div class="card-body">
                    <div class="mb-3">
                        <input type="text" class="form-control" id="buscarCliente" placeholder="Buscar cliente...">
                    </div>
                    <div class="table-responsive">
                        <table class="table table-striped" id="tablaClientes">
                            <thead>
                                <tr>
                                    <th>Nombre</th>
                                    <th>Email</th>
                                    <th>Tel칠fono</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                    <nav aria-label="Paginaci칩n de clientes">
                        <ul class="pagination justify-content-center" id="paginacionClientes"></ul>
                    </nav>
                </div>
            </div>
        </div>
    </div>

    <!-- Modales para crear/editar -->
    <div class="modal fade" id="modalProducto" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Producto</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="formProducto">
                        <input type="hidden" id="productoId">
                        <div class="mb-3">
                            <label for="nombreProducto" class="form-label">Nombre</label>
                            <input type="text" class="form-control" id="nombreProducto" required>
                        </div>
                        <div class="mb-3">
                            <label for="precioProducto" class="form-label">Precio</label>
                            <input type="number" class="form-control" id="precioProducto" required>
                        </div>
                        <div class="mb-3">
                            <label for="stockProducto" class="form-label">Stock</label>
                            <input type="number" class="form-control" id="stockProducto" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                    <button type="button" class="btn btn-primary" onclick="guardarProducto()">Guardar</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="modalCompra" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Compra</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="formCompra">
                        <input type="hidden" id="compraId">
                        <div class="mb-3">
                            <label for="proveedorCompra" class="form-label">Proveedor</label>
                            <select class="form-select" id="proveedorCompra" required></select>
                        </div>
                        <div id="productosCompra">
                            <!-- Aqu칤 se agregar치n din치micamente los productos de la compra -->
                        </div>
                        <button type="button" class="btn btn-secondary mt-2" onclick="agregarProductoCompra()">Agregar Producto</button>
                        <div class="mt-3">
                            <strong>Total: $<span id="totalCompra">0.00</span></strong>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                    <button type="button" class="btn btn-primary" onclick="guardarCompra()">Guardar</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="modalProveedor" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Proveedor</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="formProveedor">
                        <input type="hidden" id="proveedorId">
                        <div class="mb-3">
                            <label for="nombreProveedor" class="form-label">Nombre</label>
                            <input type="text" class="form-control" id="nombreProveedor" required>
                        </div>
                        <div class="mb-3">
                            <label for="emailProveedor" class="form-label">Email</label>
                            <input type="email" class="form-control" id="emailProveedor" required>
                        </div>
                        <div class="mb-3">
                            <label for="telefonoProveedor" class="form-label">Tel칠fono</label>
                            <input type="tel" class="form-control" id="telefonoProveedor" required>
                        </div>
                        <div class="mb-3">
                            <label for="direccionProveedor" class="form-label">Direcci칩n</label>
                            <input type="text" class="form-control" id="direccionProveedor" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                    <button type="button" class="btn btn-primary" onclick="guardarProveedor()">Guardar</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="modalCliente" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Cliente</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="formCliente">
                        <input type="hidden" id="clienteId">
                        <div class="mb-3">
                            <label for="nombreCliente" class="form-label">Nombre</label>
                            <input type="text" class="form-control" id="nombreCliente" required>
                        </div>
                        <div class="mb-3">
                            <label for="cedulaCliente" class="form-label">C칠dula</label>
                            <input type="text" class="form-control" id="cedulaCliente" required>
                        </div>
                        <div class="mb-3">
                            <label for="emailCliente" class="form-label">Email</label>
                            <input type="email" class="form-control" id="emailCliente" required>
                        </div>
                        <div class="mb-3">
                            <label for="telefonoCliente" class="form-label">Tel칠fono</label>
                            <input type="tel" class="form-control" id="telefonoCliente" required>
                        </div>
                        <div class="mb-3">
                            <label for="direccionCliente" class="form-label">Direcci칩n</label>
                            <input type="text" class="form-control" id="direccionCliente" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                    <button type="button" class="btn btn-primary" onclick="guardarCliente()">Guardar</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.all.min.js"></script>
    <script>
        const API_URL = 'https://tony-m6cg.onrender.com/api';
        let currentSection = 'productos';
        const itemsPerPage = 10;
        let currentPage = 1;

        // Funciones de utilidad
        function showSection(section) {
            document.querySelectorAll('.section').forEach(el => el.style.display = 'none');
            document.getElementById(section).style.display = 'block';
            currentSection = section;
            currentPage = 1;
            loadData();
        }

        function showModal(type) {
            const modal = new bootstrap.Modal(document.getElementById(`modal${type.charAt(0).toUpperCase() + type.slice(1)}`));
            modal.show();
        }

        async function fetchData(endpoint) {
            try {
                const response = await fetch(`${API_URL}/${endpoint}`);
                if (!response.ok) throw new Error('Network response was not ok');
                return await response.json();
            } catch (error) {
                console.error('Error fetching data:', error);
                Swal.fire('Error', 'Hubo un problema al cargar los datos', 'error');
            }
        }

        async function postData(endpoint, data) {
            try {
                const response = await fetch(`${API_URL}/${endpoint}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                if (!response.ok) throw new Error('Network response was not ok');
                return await response.json();
            } catch (error) {
                console.error('Error posting data:', error);
                Swal.fire('Error', 'Hubo un problema al guardar los datos', 'error');
            }
        }

        async function putData(endpoint, id, data) {
            try {
                const response = await fetch(`${API_URL}/${endpoint}/${id}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                if (!response.ok) throw new Error('Network response was not ok');
                return await response.json();
            } catch (error) {
                console.error('Error updating data:', error);
                Swal.fire('Error', 'Hubo un problema al actualizar los datos', 'error');
            }
        }

        async function deleteData(endpoint, id) {
            try {
                const response = await fetch(`${API_URL}/${endpoint}/${id}`, { method: 'DELETE' });
                if (!response.ok) throw new Error('Network response was not ok');
                return await response.json();
            } catch (error) {
                console.error('Error deleting data:', error);
                Swal.fire('Error', 'Hubo un problema al eliminar los datos', 'error');
            }
        }

        function createPagination(totalItems, containerId) {
            const totalPages = Math.ceil(totalItems / itemsPerPage);
            const container = document.getElementById(containerId);
            container.innerHTML = '';

            for (let i = 1; i <= totalPages; i++) {
                const li = document.createElement('li');
                li.className = `page-item ${i === currentPage ? 'active' : ''}`;
                const a = document.createElement('a');
                a.className = 'page-link';
                a.href = '#';
                a.textContent = i;
                a.onclick = (e) => {
                    e.preventDefault();
                    currentPage = i;
                    loadData();
                };
                li.appendChild(a);
                container.appendChild(li);
            }
        }

        // Funciones espec칤ficas para cada secci칩n
        async function loadProductos() {
            const productos = await fetchData('productos');
            const tabla = document.getElementById('tablaProductos').getElementsByTagName('tbody')[0];
            tabla.innerHTML = '';
            productos.slice((currentPage - 1) * itemsPerPage, currentPage * itemsPerPage).forEach(producto => {
                const row = tabla.insertRow();
                row.innerHTML = `
                    <td>${producto.nombre}</td>
                    <td>$${producto.precio.toFixed(2)}</td>
                    <td>${producto.stock}</td>
                    <td>
                        <button class="btn btn-sm btn-primary" onclick="editarProducto('${producto._id}')">Editar</button>
                        <button class="btn btn-sm btn-danger" onclick="eliminarProducto('${producto._id}')">Eliminar</button>
                    </td>
                `;
            });
            createPagination(productos.length, 'paginacionProductos');
        }

        async function loadCompras() {
            const compras = await fetchData('compras');
            const tabla = document.getElementById('tablaCompras').getElementsByTagName('tbody')[0];
            tabla.innerHTML = '';
            compras.slice((currentPage - 1) * itemsPerPage, currentPage * itemsPerPage).forEach(compra => {
                const row = tabla.insertRow();
                row.innerHTML = `
                    <td>${new Date(compra.fecha).toLocaleDateString()}</td>
                    <td>${compra.proveedor.nombre}</td>
                    <td>$${compra.total.toFixed(2)}</td>
                    <td>${compra.estado}</td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="verDetalleCompra('${compra._id}')">Ver Detalle</button>
                        <button class="btn btn-sm btn-warning" onclick="anularCompra('${compra._id}')" ${compra.estado === 'Anulada' ? 'disabled' : ''}>Anular</button>
                    </td>
                `;
            });
            createPagination(compras.length, 'paginacionCompras');
        }

        async function loadProveedores() {
            const proveedores = await fetchData('proveedores');
            const tabla = document.getElementById('tablaProveedores').getElementsByTagName('tbody')[0];
            tabla.innerHTML = '';
            proveedores.slice((currentPage - 1) * itemsPerPage, currentPage * itemsPerPage).forEach(proveedor => {
                const row = tabla.insertRow();
                row.innerHTML = `
                    <td>${proveedor.nombre}</td>
                    <td>${proveedor.email}</td>
                    <td>${proveedor.telefono}</td>
                    <td>
                        <button class="btn btn-sm btn-primary" onclick="editarProveedor('${proveedor._id}')">Editar</button>
                        <button class="btn btn-sm btn-danger" onclick="eliminarProveedor('${proveedor._id}')">Eliminar</button>
                    </td>
                `;
            });
            createPagination(proveedores.length, 'paginacionProveedores');
        }

        async function loadClientes() {
            const clientes = await fetchData('clientes');
            const tabla = document.getElementById('tablaClientes').getElementsByTagName('tbody')[0];
            tabla.innerHTML = '';
            clientes.slice((currentPage - 1) * itemsPerPage, currentPage * itemsPerPage).forEach(cliente => {
                const row = tabla.insertRow();
                row.innerHTML = `
                    <td>${cliente.nombreCliente}</td>
                    <td>${cliente.email}</td>
                    <td>${cliente.telefono}</td>
                    <td>
                        <button class="btn btn-sm btn-primary" onclick="editarCliente('${cliente._id}')">Editar</button>
                        <button class="btn btn-sm btn-danger" onclick="eliminarCliente('${cliente._id}')">Eliminar</button>
                    </td>
                `;
            });
            createPagination(clientes.length, 'paginacionClientes');
        }

        function loadData() {
            switch (currentSection) {
                case 'productos':
                    loadProductos();
                    break;
                case 'compras':
                    loadCompras();
                    break;
                case 'proveedores':
                    loadProveedores();
                    break;
                case 'clientes':
                    loadClientes();
                    break;
            }
        }

        // Funciones para manejar productos
        async function guardarProducto() {
            const producto = {
                nombre: document.getElementById('nombreProducto').value,
                precio: parseFloat(document.getElementById('precioProducto').value),
                stock: parseInt(document.getElementById('stockProducto').value)
            };
            const id = document.getElementById('productoId').value;
            let result;
            if (id) {
                result = await putData('productos', id, producto);
            } else {
                result = await postData('productos', producto);
            }
            if (result) {
                Swal.fire('칄xito', 'Producto guardado correctamente', 'success');
                bootstrap.Modal.getInstance(document.getElementById('modalProducto')).hide();
                loadProductos();
            }
        }

        async function editarProducto(id) {
            const producto = await fetchData(`productos/${id}`);
            document.getElementById('productoId').value = producto._id;
            document.getElementById('nombreProducto').value = producto.nombre;
            document.getElementById('precioProducto').value = producto.precio;
            document.getElementById('stockProducto').value = producto.stock;
            showModal('producto');
        }

        async function eliminarProducto(id) {
            const result = await Swal.fire({
                title: '쮼st치s seguro?',
                text: "No podr치s revertir esta acci칩n",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'S칤, eliminar'
            });
            if (result.isConfirmed) {
                const response = await deleteData('productos', id);
                if (response) {
                    Swal.fire('Eliminado', 'El producto ha sido eliminado', 'success');
                    loadProductos();
                }
            }
        }

        // Funciones para manejar compras
        let productosCompra = [];

        async function agregarProductoCompra() {
            const productos = await fetchData('productos');
            const { value: formValues } = await Swal.fire({
                title: 'Agregar Producto a la Compra',
                html:
                    '<select id="swal-producto" class="swal2-input">' +
                    productos.map(p => `<option value="${p._id}">${p.nombre}</option>`).join('') +
                    '</select>' +
                    '<input id="swal-cantidad" class="swal2-input" placeholder="Cantidad">' +
                    '<input id="swal-precio" class="swal2-input" placeholder="Precio Unitario">',
                focusConfirm: false,
                preConfirm: () => {
                    return {
                        producto: document.getElementById('swal-producto').value,
                        cantidad: document.getElementById('swal-cantidad').value,
                        precioUnitario: document.getElementById('swal-precio').value
                    }
                }
            });

            if (formValues) {
                const producto = productos.find(p => p._id === formValues.producto);
                productosCompra.push({
                    producto: formValues.producto,
                    nombre: producto.nombre,
                    cantidad: parseInt(formValues.cantidad),
                    precioUnitario: parseFloat(formValues.precioUnitario)
                });
                actualizarProductosCompra();
            }
        }

        function actualizarProductosCompra() {
            const container = document.getElementById('productosCompra');
            container.innerHTML = '';
            let total = 0;
            productosCompra.forEach((p, index) => {
                const subtotal = p.cantidad * p.precioUnitario;
                total += subtotal;
                container.innerHTML += `
                    <div class="mb-2">
                        <strong>${p.nombre}</strong> - 
                        Cantidad: ${p.cantidad}, 
                        Precio: $${p.precioUnitario.toFixed(2)}, 
                        Subtotal: $${subtotal.toFixed(2)}
                        <button type="button" class="btn btn-sm btn-danger" onclick="eliminarProductoCompra(${index})">Eliminar</button>
                    </div>
                `;
            });
            document.getElementById('totalCompra').textContent = total.toFixed(2);
        }

        function eliminarProductoCompra(index) {
            productosCompra.splice(index, 1);
            actualizarProductosCompra();
        }

        async function guardarCompra() {
            const compra = {
                proveedor: document.getElementById('proveedorCompra').value,
                detalles: productosCompra.map(p => ({
                    producto: p.producto,
                    cantidad: p.cantidad,
                    precioUnitario: p.precioUnitario
                }))
            };
            const result = await postData('compras', compra);
            if (result) {
                Swal.fire('칄xito', 'Compra guardada correctamente', 'success');
                bootstrap.Modal.getInstance(document.getElementById('modalCompra')).hide();
                productosCompra = [];
                loadCompras();
            }
        }

        async function verDetalleCompra(id) {
            const compra = await fetchData(`compras/${id}`);
            let detalleHtml = `
                <h3>Detalles de la Compra</h3>
                <p><strong>Fecha:</strong> ${new Date(compra.compra.fecha).toLocaleDateString()}</p>
                <p><strong>Proveedor:</strong> ${compra.compra.proveedor.nombre}</p>
                <p><strong>Estado:</strong> ${compra.compra.estado}</p>
                <h4>Productos:</h4>
                <ul>
            `;
            compra.detalles.forEach(detalle => {
                detalleHtml += `
                    <li>${detalle.producto.nombre} - Cantidad: ${detalle.cantidad}, Precio: $${detalle.precioUnitario.toFixed(2)}, Subtotal: $${detalle.total.toFixed(2)}</li>
                `;
            });
            detalleHtml += `</ul><p><strong>Total:</strong> $${compra.compra.total.toFixed(2)}</p>`;
            
            Swal.fire({
                title: 'Detalle de Compra',
                html: detalleHtml,
                width: 600,
                confirmButtonText: 'Cerrar'
            });
        }

        async function anularCompra(id) {
            const result = await Swal.fire({
                title: '쮼st치s seguro?',
                text: "Esta acci칩n anular치 la compra",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'S칤, anular'
            });
            if (result.isConfirmed) {
                const response = await putData('compras', id, { estado: 'Anulada' });
                if (response) {
                    Swal.fire('Anulada', 'La compra ha sido anulada', 'success');
                    loadCompras();
                }
            }
        }

        // Funciones para manejar proveedores
        async function guardarProveedor() {
            const proveedor = {
                nombre: document.getElementById('nombreProveedor').value,
                email: document.getElementById('emailProveedor').value,
                telefono: document.getElementById('telefonoProveedor').value,
                direccion: document.getElementById('direccionProveedor').value
            };
            const id = document.getElementById('proveedorId').value;
            let result;
            if (id) {
                result = await putData('proveedores', id, proveedor);
            } else {
                result = await postData('proveedores', proveedor);
            }
            if (result) {
                Swal.fire('칄xito', 'Proveedor guardado correctamente', 'success');
                bootstrap.Modal.getInstance(document.getElementById('modalProveedor')).hide();
                loadProveedores();
            }
        }

        async function editarProveedor(id) {
            const proveedor = await fetchData(`proveedores/${id}`);
            document.getElementById('proveedorId').value = proveedor._id;
            document.getElementById('nombreProveedor').value = proveedor.nombre;
            document.getElementById('emailProveedor').value = proveedor.email;
            document.getElementById('telefonoProveedor').value = proveedor.telefono;
            document.getElementById('direccionProveedor').value = proveedor.direccion;
            showModal('proveedor');
        }

        async function eliminarProveedor(id) {
            const result = await Swal.fire({
                title: '쮼st치s seguro?',
                text: "No podr치s revertir esta acci칩n",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'S칤, eliminar'
            });
            if (result.isConfirmed) {
                const response = await deleteData('proveedores', id);
                if (response) {
                    Swal.fire('Eliminado', 'El proveedor ha sido eliminado', 'success');
                    loadProveedores();
                }
            }
        }

        // Funciones para manejar clientes
        async function guardarCliente() {
            const cliente = {
                nombreCliente: document.getElementById('nombreCliente').value,
                cedula: document.getElementById('cedulaCliente').value,
                email: document.getElementById('emailCliente').value,
                telefono: document.getElementById('telefonoCliente').value,
                direccion: document.getElementById('direccionCliente').value
            };
            const id = document.getElementById('clienteId').value;
            let result;
            if (id) {
                result = await putData('clientes', id, cliente);
            } else {
                result = await postData('clientes', cliente);
            }
            if (result) {
                Swal.fire('칄xito', 'Cliente guardado correctamente', 'success');
                bootstrap.Modal.getInstance(document.getElementById('modalCliente')).hide();
                loadClientes();
            }
        }

        async function editarCliente(id) {
            const cliente = await fetchData(`clientes/${id}`);
            document.getElementById('clienteId').value = cliente._id;
            document.getElementById('nombreCliente').value = cliente.nombreCliente;
            document.getElementById('cedulaCliente').value = cliente.cedula;
            document.getElementById('emailCliente').value = cliente.email;
            document.getElementById('telefonoCliente').value = cliente.telefono;
            document.getElementById('direccionCliente').value = cliente.direccion;
            showModal('cliente');
        }

        async function eliminarCliente(id) {
            const result = await Swal.fire({
                title: '쮼st치s seguro?',
                text: "No podr치s revertir esta acci칩n",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'S칤, eliminar'
            });
            if (result.isConfirmed) {
                const response = await deleteData('clientes', id);
                if (response) {
                    Swal.fire('Eliminado', 'El cliente ha sido eliminado', 'success');
                    loadClientes();
                }
            }
        }

        // Inicializaci칩n
        document.addEventListener('DOMContentLoaded', () => {
            loadData();
            // Configurar buscadores
            ['Producto', 'Compra', 'Proveedor', 'Cliente'].forEach(tipo => {
                document.getElementById(`buscar${tipo}`).addEventListener('input', (e) => {
                    const searchTerm = e.target.value.toLowerCase();
                    const rows = document.querySelectorAll(`#tabla${tipo}s tbody tr`);
                    rows.forEach(row => {
                        const text = row.textContent.toLowerCase();
                        row.style.display = text.includes(searchTerm) ? '' : 'none';
                    });
                });
            });
        });
    </script>
</body>
</html>